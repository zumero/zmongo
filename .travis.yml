language: rust

services:
    - "mongodb"

before_install:
    - sudo apt-get install git-core automake autoconf libtool gcc
    - git clone git://github.com/mongodb/libbson.git
    - cd libbson
    - ./autogen.sh
    - make
    - sudo make install
    - sudo ldconfig /usr/local/lib

before_script: "echo \"db.test.insert({ foo: 42 }); db.getSiblingDB('sample').movies.insert({ title: 'Jaws' });\" | mongo"

script:
    - cargo build --verbose
    - cargo test --verbose
